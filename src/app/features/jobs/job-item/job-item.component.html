<div class="glass-card-hover p-6 group" [ngClass]="compact ? 'flex flex-col h-full' : ''">
    <!-- List layout -->
    <div *ngIf="!compact" class="flex flex-col sm:flex-row sm:items-start justify-between gap-4">
        <div class="flex-1 min-w-0">
            <div class="flex items-start gap-3">
                <div
                    class="w-11 h-11 bg-gradient-to-br from-teal-50 to-emerald-50 rounded-xl flex items-center justify-center flex-shrink-0 border border-teal-200">
                    <span class="text-sm font-bold text-teal-600">{{ job.company.charAt(0) || 'J' }}</span>
                </div>
                <div class="min-w-0">
                    <h3
                        class="text-base font-semibold text-gray-900 group-hover:text-teal-600 transition-colors truncate">
                        {{ job.title }}</h3>
                    <p class="text-sm text-gray-500 mt-0.5">{{ job.company }}</p>
                </div>
            </div>

            <p class="text-sm text-gray-500 mt-3 line-clamp-2 leading-relaxed">{{ job.description }}</p>

            <div class="flex flex-wrap items-center gap-2 mt-3">
                <span class="badge-info flex items-center gap-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    {{ job.location }}
                </span>
                <span class="badge-success">{{ job.type || 'Full-time' }}</span>
                <span *ngIf="job.salary" class="badge-warning">{{ job.salary }}</span>
                <span class="text-xs text-gray-400">{{ job.datePosted | relativeTime }}</span>
            </div>
        </div>

        <div class="flex sm:flex-col items-center gap-2 flex-shrink-0">
            <button (click)="openExternalUrl()" class="btn-primary text-xs py-2 px-4 whitespace-nowrap">
                View Offer
            </button>
            <ng-container *ngIf="authService.isAuthenticated()">
                <button (click)="toggleFavorite()"
                    class="btn-glass text-xs py-2 px-4 whitespace-nowrap flex items-center gap-1.5">
                    <svg class="w-4 h-4" [class.text-red-500]="(isFavorite$ | async)"
                        [class.fill-red-500]="(isFavorite$ | async)" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                    </svg>
                    {{ (isFavorite$ | async) ? 'Saved' : 'Save' }}
                </button>
                <button (click)="trackApplication()" [disabled]="isApplied"
                    class="btn-glass text-xs py-2 px-4 whitespace-nowrap flex items-center gap-1.5 disabled:opacity-40">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                    </svg>
                    {{ isApplied ? 'Tracked' : 'Track' }}
                </button>
            </ng-container>
        </div>
    </div>

    <!-- Grid / Card layout -->
    <ng-container *ngIf="compact">
        <div class="flex items-start gap-3 mb-3">
            <div
                class="w-11 h-11 bg-gradient-to-br from-teal-50 to-emerald-50 rounded-xl flex items-center justify-center flex-shrink-0 border border-teal-200">
                <span class="text-sm font-bold text-teal-600">{{ job.company.charAt(0) || 'J' }}</span>
            </div>
            <div class="min-w-0">
                <h3 class="text-base font-semibold text-gray-900 group-hover:text-teal-600 transition-colors truncate">
                    {{ job.title }}</h3>
                <p class="text-sm text-gray-500 mt-0.5">{{ job.company }}</p>
            </div>
        </div>

        <p class="text-sm text-gray-500 line-clamp-2 leading-relaxed mb-3 flex-1">{{ job.description }}</p>

        <div class="flex flex-wrap items-center gap-2 mb-4">
            <span class="badge-info flex items-center gap-1 text-[11px]">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                </svg>
                {{ job.location }}
            </span>
            <span class="badge-success text-[11px]">{{ job.type || 'Full-time' }}</span>
            <span *ngIf="job.salary" class="badge-warning text-[11px]">{{ job.salary }}</span>
        </div>

        <div class="flex items-center gap-2 mt-auto pt-3 border-t border-gray-100">
            <button (click)="openExternalUrl()" class="btn-primary text-xs py-1.5 px-3 flex-1">View</button>
            <ng-container *ngIf="authService.isAuthenticated()">
                <button (click)="toggleFavorite()" class="btn-icon" [class.text-red-500]="(isFavorite$ | async)">
                    <svg class="w-5 h-5" [class.fill-red-500]="(isFavorite$ | async)" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                    </svg>
                </button>
                <button (click)="trackApplication()" [disabled]="isApplied" class="btn-icon disabled:opacity-40">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                    </svg>
                </button>
            </ng-container>
        </div>

        <p class="text-[11px] text-gray-400 mt-2">{{ job.datePosted | relativeTime }}</p>
    </ng-container>
</div>